# Engine attempt

[TOC]

### 项目介绍

​	这是一次简易2D物理引擎开发的尝试，内容较为简陋，甚至我觉得它只像一个演示动画:(   ，物体只有球体。

### 实现原理

​	这个物理引擎包含了两个模块，计算和显示。

#### 计算

​	其中计算部分主要运用动量定理和牛顿运动学公式来进行碰撞处理和位置更新。主要实现成员函数为边缘检测及其处理方法，碰撞检测及其处理方法，重力加速度函数和位置更新函数，此部分为简单物理知识的运用，不用赘述了。还有一些次要函数用于返回位置的横纵坐标等来便于计算处理。其中引用了培训时第一次小作业开发的Vect类来实现向量的基本运算。

#### 显示

​	虽然作业说明文件中对显示部分一笔带过，但这个部分其实困扰了我不少时间，也没有找到好的解决方法。我是用opencv来实现显示功能的。最终实现方法是通过opencv中的addWeighted函数来实现两张图片的融合，即将小球图片与背景在小球坐标处融合，再逐帧更新位置显示，每帧之间将背景清空重新融合，最后就是实现流畅的显示效果。但是依旧存在瑕疵，这个融合是通过再背景图片中小球对应位置选取ROI区域与小球贴图融合，但是搜索了很久也没有找到能在这里应用的圆形ROI的选取。只能选择矩形ROI区域，这条路走不通;于是在选择矩形ROI区域的情况下，我又想通过Photoshop将小球其余部分背景改为透明背景导出png格式来实现显示，但是透明背景在opencv显示后会变成白色，网上有一些不同的解答我都尝试无果，总体资料偏少，最终也没能解决。这也是目前仍存的显示问题的一点瑕疵，有待解决。

### 代码结构

​	共有六个文件，分别为display,object和engine的头文件和源文件。其中display文件封装显示模块和导入贴图素材。engine文件封装了向量类。object文件封装了刚体类及其派生球类以及演示程序main函数，其中计算部分的函数均为球类的成员函数。

### 第三方库

```
#include <opencv2/opencv.hpp> 
#include <cmath>
#include <opencv2/core/core.hpp>  
#include <opencv2/highgui/highgui.hpp> 
```

### 暂存缺陷总结

​	显示贴图为矩形，在碰撞时偶尔会有球体外的边角贴图重叠；

​	创建新球体要手动导入新贴图，不能按输入数据自动生成，得按贴图数据对应生成球体；

​	碰撞检测函数还不会遍历球类对象，暂时得手动遍历输入检测对象。

### GitHub地址

​	https://github.com/Iscream132/Engine-attempt
